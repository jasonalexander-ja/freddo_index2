(this["webpackJsonpfreddo-index"]=this["webpackJsonpfreddo-index"]||[]).push([[0],{16:function(e,t,r){},17:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),s=r(2),c=r(4),o=r(5),i=r(7),u=r(6),p=r(0),h=r(3),l=r.n(h),x=r(9),f=r.n(x);r(16);var g=function(e){Object(i.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(c.a)(this,r),n=t.call(this,e),console.log("new Graph()"),n.state={graphHeight:n.props.graphHeight?n.props.graphHeight:220,graphWidth:n.props.graphWidth?n.props.graphWidth:400,textClassName:n.props.className?n.props.textClassName:"",lineClassName:n.props.lineClassName?n.props.lineClassName:"",xTextOffset:n.props.xTextOffset?n.props.xTextOffset:2,yTextOffset:n.props.yTextOffset?n.props.yTextOffset:2,xLabels:n.props.numXLabels?n.props.numXLabels:2,yLabels:n.props.numYLabels?n.props.numYLabels:2},n}return Object(o.a)(r,[{key:"render",value:function(){if(!("x"in(e=this.props.graphData)[0])||!("y"in e[0]))return Object(p.jsxs)("p",{children:["Data set needs to contain at least 1 ","{{x: 0, y: 0}}"," array entry"]});var e,t=this.props.xOffset?this.props.xOffset:35,r=this.props.yOffset?this.props.xOffset:35,n=function(e){var t=e.map((function(e){return{x:e.x,y:parseFloat(e.y)}})),r=e[0].x,n=0,a=t[0].y,s=0;t.forEach((function(e){r=r>e.x?e.x:r,n=n<e.x?e.x:n,a=a>e.y?e.y:a,s=s<e.y?e.y:s}));var c=n-r,o=(s-a).toFixed(2);return{xMin:r,yMin:a,xMax:n,yMax:s,xRange:c,yRange:o}}(this.props.graphData),a=function(e,t,r,n,a,s){var c=n-2*s,o=r-2*a,i=e.map((function(e){return{x:e.x,y:parseFloat(e.y)}})),u=t.xMin,p=t.yMin,h=t.xRange,l=t.yRange,x=o/h,f=0-u,g=c/l,d=0-p;return i.map((function(e){return{x:Math.floor((e.x+f)*x)+a,y:c-Math.floor((e.y+d)*g)+s}}))}(this.props.graphData,n,this.state.graphWidth,this.state.graphHeight,t,r),s=function(e,t,r,n,a,s,c,o,i,u){for(var h=c-2*i,l=o-2*u,x=e.xRange/a,f=e.yRange/s,g=h/a,d=l/s,y=[],j=0;j<=a;j++){var b=j*g,O=parseFloat((e.xMin+j*x).toFixed(0)).toString();y.push(Object(p.jsx)("text",{x:i+b,y:o-t,className:n,children:O},"x".concat(j)))}for(var v=0;v<=s;v++){var m=v*d,w=parseFloat((e.yMin+v*f).toFixed(2)).toString();y.push(Object(p.jsx)("text",{x:r,y:o-m-u,className:n,children:w},"y".concat(v)))}return y}(n,this.state.xTextOffset,this.state.yTextOffset,this.state.textClassName,this.state.xLabels,this.state.yLabels,this.state.graphWidth,this.state.graphHeight,t,r),c="";return a.forEach((function(e){c+="".concat(e.x,",").concat(e.y," ")})),Object(p.jsx)("div",{children:Object(p.jsxs)("svg",{width:"".concat(this.props.graphWidth),height:"".concat(this.props.graphHeight),className:this.props.className,children:[Object(p.jsx)("polyline",{points:c,className:this.state.lineClassName}),s]})})}}]),r}(l.a.Component);var d="/",y=function(e){Object(i.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).state={year:(new Date).getFullYear(),currency:"GBP",costPs:j(n.props.changeObj,(new Date).getFullYear()),exchangeRates:n.props.currentRates,exchangeRate:1,error:!1,errorMsg:""},n}return Object(o.a)(r,[{key:"updateYear",value:function(e){var t=this.props.periodExchangeObj["".concat(e)];if(t){if(!t[this.state.currency]){var r="",n=this.state.currency;return this.props.currencyOptions.forEach((function(e){e.code===n&&(r=e.value)})),void this.setState({error:!0,errorMsg:"No data for ".concat(r," for ").concat(e,".")})}this.setState({year:e,costPs:j(this.props.changeObj,e),exchangeRates:t,exchangeRate:t[this.state.currency],error:!1,errorMsg:""})}else this.setState({error:!0,errorMsg:"Couldn't load exchange rates for year ".concat(e)})}},{key:"updateCurrency",value:function(e){if(this.state.exchangeRates[e])this.setState({exchangeRate:this.state.exchangeRates[e],currency:e,error:!1,errorMsg:""});else{var t="";this.props.currencyOptions.forEach((function(r){r.code===e&&(t=r.value)})),this.setState({error:!0,errorMsg:"No data for ".concat(t," for ").concat(this.state.year,".")})}}},{key:"getGraphData",value:function(){for(var e=this,t=this.props.changeObj,r=(new Date).getFullYear()-new Date(t[0].x).getFullYear(),n=new Date(t[0].x).getFullYear(),a=this.state.currency,s=[],c=0;c<=r;c++)s.push({x:new Date(t[0].x).getFullYear()+c,y:j(t,n+c)});var o=[];return s.forEach((function(t,r){var s=e.props.periodExchangeObj[n+r][a];s&&o.push({x:t.x,y:parseFloat((t.y*s).toFixed(2))})})),o}},{key:"render",value:function(){var e=this,t=function(e,t,r){for(var n=[],a=e.map((function(e){return new Date(e.x).getFullYear()}))[0];a<=(new Date).getFullYear();a++)t[a]&&r in t[a]&&n.push(Object(p.jsx)("option",{value:a,children:a},a));return n.reverse()}(this.props.changeObj,this.props.periodExchangeObj,this.state.currency),r=this.props.currencyOptions.map((function(t){var r=!(t.code in e.state.exchangeRates);return Object(p.jsx)("option",{value:t.code,hidden:r,children:t.value},t.code)})),n=this.getGraphData();return Object(p.jsxs)("div",{className:"mainBody",children:[Object(p.jsx)("h1",{className:"main_title",children:"International Freddo Index"}),Object(p.jsx)("br",{}),Object(p.jsxs)("div",{className:"inputLine",children:[Object(p.jsxs)("div",{className:"inputGroup",children:[Object(p.jsx)("label",{children:"Year: "}),Object(p.jsx)("select",{id:"year",value:this.state.year,onChange:function(){e.updateYear(document.getElementById("year").value)},children:t})]}),"\xa0\xa0",Object(p.jsxs)("div",{className:"inputGroup",children:[Object(p.jsx)("label",{children:"Currency: "}),Object(p.jsx)("select",{id:"currency",value:this.state.currency,onChange:function(){e.updateCurrency(document.getElementById("currency").value)},children:r})]}),Object(p.jsxs)("nobr",{className:"text",children:["1 Freddo :"," ".concat((this.state.costPs*this.state.exchangeRate).toFixed(2)," ").concat(this.state.currency)]}),"\xa0\xa0",Object(p.jsx)("nobr",{className:"errorText",children:this.state.errorMsg})]})," ",Object(p.jsx)("br",{}),Object(p.jsx)("div",{className:"kpiHolder",children:Object(p.jsx)(g,{className:"mainKpi",graphWidth:400,graphHeight:220,graphData:n,textClassName:"kpiText",xTextOffset:5,yTextOffset:5,lineClassName:"line"})})]})}}]),r}(l.a.Component);function j(e,t){var r=e.map((function(e){return{x:new Date(e.x).getFullYear(),y:e.y}}));if(t<r[0].x)return r[0].y;if(t>=r[r.length-1].x)return r[r.length-1].y;for(var n=0;n<=r.length-2;n++)if(t>=r[n].x&&t<r[n+1].x)return r[n].y;return 0}function b(e){return O.apply(this,arguments)}function O(){return(O=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return m.apply(this,arguments)}function m(){return(m=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b("".concat(d,"change-points.json")).then((function(e){return e.changePoints})).catch((function(e){return console.log("Error getting change data."),[{x:"1999-01-01T00:00:00.000Z",y:0}]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return F.apply(this,arguments)}function F(){return(F=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b("".concat(d,"currency-values.json")).then((function(e){return e.options})).catch((function(e){return console.log("Failed to get currency options."),[{code:"GBP",value:"GB Pound Sterling"}]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return D.apply(this,arguments)}function D(){return(D=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b("https://api.exchangeratesapi.io/".concat((new Date).getFullYear(),"-01-01?base=GBP")).then((function(e){return e.success?e.rates:{GBP:1}})).catch((function(e){return console.log("Failed to get initial conversion object."),{GBP:1}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(s.a)(a.a.mark((function e(t,r){var n,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={},s=a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("https://api.exchangeratesapi.io/".concat(t,"-01-01?base=GBP")).then((function(e){return e})).catch((function(e){return console.log("Error getting exchange rates for period ".concat(t,".")),{rates:{GPB:1}}}));case 2:(r=e.sent).success?n[t.toString()]=r.rates:n[t.toString()]={GBP:1};case 4:case"end":return e.stop()}}),e)})),c=t;case 3:if(!(c<=r)){e.next=8;break}return e.delegateYield(s(c),"t0",5);case 5:c++,e.next=3;break;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(s.a)(a.a.mark((function e(){var t,r,n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("/data-origin.json").then((function(e){return e.origin})).catch((function(e){return"/"}));case 2:return d=e.sent,e.next=5,v();case 5:return t=e.sent,e.next=8,w();case 8:return r=e.sent,e.next=11,N();case 11:return n=e.sent,e.next=14,k(new Date(t[0].x).getFullYear(),(new Date).getFullYear());case 14:s=e.sent,f.a.render(Object(p.jsx)(y,{changeObj:t,currencyOptions:r,currentRates:n,periodExchangeObj:s}),document.getElementById("root"));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){C.apply(this,arguments)}()}},[[17,1,2]]]);
//# sourceMappingURL=main.21d1c73d.chunk.js.map